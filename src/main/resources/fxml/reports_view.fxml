<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>
<?import javafx.geometry.Insets?>
<?import de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView?>

<VBox xmlns:fx="http://javafx.com/fxml" fx:controller="com.smartpos.ui.ReportsViewController" spacing="20" style="-fx-padding: 20;">
    
    <Label text="Savdo Analitikasi" styleClass="view-title"/>

    <TabPane VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE">
        <tabs>
            <Tab text="ASOSIY KO'RSATKICHLAR">
                <VBox spacing="30" style="-fx-padding: 30;">
                    <!-- Key Metrics - Premium Cards -->
                    <HBox spacing="25" alignment="CENTER">
                        <VBox styleClass="metric-card" prefWidth="280" spacing="10">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView glyphName="MONEY" size="24" fill="#00f2fe"/>
                                <Label text="UMUMIY TUSHUM" styleClass="metric-label"/>
                            </HBox>
                            <HBox spacing="5" alignment="BOTTOM_LEFT">
                                <Label text="So'm" style="-fx-font-size: 14px; -fx-text-fill: #00f2fe; -fx-opacity: 0.7;"/>
                                <Label fx:id="totalRevenueLabel" text="0.00" styleClass="metric-value"/>
                            </HBox>
                        </VBox>
                        
                        <VBox styleClass="metric-card" prefWidth="280" spacing="10">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView glyphName="SHOPPING_CART" size="24" fill="#f093fb"/>
                                <Label text="TRANZAKSIYALAR" styleClass="metric-label"/>
                            </HBox>
                            <Label fx:id="totalSalesCountLabel" text="0" styleClass="metric-value" style="-fx-text-fill: #f093fb;"/>
                        </VBox>

                        <VBox styleClass="metric-card" prefWidth="280" spacing="10">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView glyphName="CALCULATOR" size="24" fill="#43e97b"/>
                                <Label text="O'RTACHA CHEK" styleClass="metric-label"/>
                            </HBox>
                            <HBox spacing="5" alignment="BOTTOM_LEFT">
                                <Label text="So'm" style="-fx-font-size: 14px; -fx-text-fill: #43e97b; -fx-opacity: 0.7;"/>
                                <Label fx:id="avgSaleLabel" text="0.00" styleClass="metric-value" style="-fx-text-fill: #43e97b;"/>
                            </HBox>
                        </VBox>

                        <VBox styleClass="metric-card" prefWidth="280" spacing="10" style="-fx-border-color: #00ff88;">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView glyphName="LINE_CHART" size="24" fill="#00ff88"/>
                                <Label text="SOF FOYDA" styleClass="metric-label"/>
                            </HBox>
                            <HBox spacing="5" alignment="BOTTOM_LEFT">
                                <Label text="So'm" style="-fx-font-size: 14px; -fx-text-fill: #00ff88; -fx-opacity: 0.7;"/>
                                <Label fx:id="netProfitLabel" text="0.00" styleClass="metric-value" style="-fx-text-fill: #00ff88;"/>
                            </HBox>
                        </VBox>
                    </HBox>

                    <HBox spacing="25" VBox.vgrow="ALWAYS">
                        <!-- Left Column: Charts -->
                        <VBox spacing="25" HBox.hgrow="ALWAYS">
                            <VBox styleClass="glass-pane" VBox.vgrow="ALWAYS" style="-fx-padding: 20;">
                                <Label text="To'lov turlari bo'yicha tranzaksiyalar" styleClass="label-sub-header"/>
                                <BarChart fx:id="salesChart" VBox.vgrow="ALWAYS" legendVisible="false" verticalGridLinesVisible="false">
                                    <xAxis><CategoryAxis fx:id="xAxis" label="To'lov turi"/></xAxis>
                                    <yAxis><NumberAxis fx:id="yAxis" label="Soni"/></yAxis>
                                </BarChart>
                            </VBox>
                            
                            <VBox styleClass="glass-pane" VBox.vgrow="ALWAYS" style="-fx-padding: 20;">
                                <Label text="Eng ko'p sotilgan 10 ta mahsulot" styleClass="label-sub-header"/>
                                <PieChart fx:id="topProductsChart" VBox.vgrow="ALWAYS" legendSide="RIGHT"/>
                            </VBox>
                        </VBox>

                        <!-- Right Column: Recent Sales Table -->
                        <VBox styleClass="glass-pane" prefWidth="450" spacing="15" style="-fx-padding: 20;">
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView glyphName="HISTORY" size="18" fill="#8e8ea0"/>
                                <Label text="OXIRGI SAVDOLAR" styleClass="label-sub-header"/>
                            </HBox>
                            <TableView fx:id="recentSalesTable" VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn fx:id="colId" text="ID" prefWidth="60"/>
                                    <TableColumn fx:id="colDate" text="Sana" prefWidth="140"/>
                                    <TableColumn fx:id="colAmount" text="Summa" prefWidth="100"/>
                                    <TableColumn fx:id="colMethod" text="Tur" prefWidth="80"/>
                                    <TableColumn fx:id="colAction" text="Amallar" prefWidth="100"/>
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                                </columnResizePolicy>
                            </TableView>
                        </VBox>
                    </HBox>
                </VBox>
            </Tab>
            
            <Tab text="TIZIM AUDITI">
                <VBox spacing="20" style="-fx-padding: 30;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <de.jensd.fx.glyphs.fontawesome.FontAwesomeIconView glyphName="SHIELD" size="24" fill="#f1c40f"/>
                        <Label text="TIZIM AMALLARI TARIXI" styleClass="label-sub-header"/>
                    </HBox>
                    <TableView fx:id="auditTable" VBox.vgrow="ALWAYS" styleClass="glass-pane">
                        <columns>
                            <TableColumn fx:id="colAuditTime" text="Vaqt" prefWidth="180"/>
                            <TableColumn fx:id="colAuditUser" text="Xodim" prefWidth="120"/>
                            <TableColumn fx:id="colAuditAction" text="Amal" prefWidth="150"/>
                            <TableColumn fx:id="colAuditDetails" text="Tafsilotlar" prefWidth="400"/>
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                        </columnResizePolicy>
                    </TableView>
                    <HBox alignment="CENTER_RIGHT" spacing="15">
                        <Button text="MA'LUMOTLARNI YANGILASH ðŸ”„" onAction="#refreshAuditLogs" styleClass="button-secondary"/>
                    </HBox>
                </VBox>
            </Tab>
        </tabs>
    </TabPane>

</VBox>
